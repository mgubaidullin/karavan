(this.webpackJsonpkaravan=this.webpackJsonpkaravan||[]).push([[0],{176:function(e,t,n){},184:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(33),c=n.n(i),r=n(112),s=n(15),o=n(7),l=n(12),u=n(16),d=n(59),f=n.n(d),p=n(94),b=n(192),j=n(193),h=n(207),m=n(194),O=n(202),v=n(32),x=n(8),g=function e(){Object(x.a)(this,e),this.id="",this.title="",this.description="",this.type="",this.default="",this.format="",this["x-descriptors"]="",this.value=""},k=function e(){Object(x.a)(this,e),this.title="",this.description="",this.required=[],this.properties={}},y=function e(){Object(x.a)(this,e),this.definition=new k,this.types={},this.flow={}},w=function e(){Object(x.a)(this,e),this["camel.apache.org/kamelet.type"]=""},C=function e(){Object(x.a)(this,e),this["camel.apache.org/kamelet.icon"]=""},N=function e(){Object(x.a)(this,e),this.name="",this.labels=new w,this.annotations=new C},S=function(){function e(){Object(x.a)(this,e),this.apiVersion="camel.apache.org/v1alpha1",this.kind="Kamelet",this.metadata=new N,this.spec=new y}return Object(v.a)(e,[{key:"type",value:function(){return this.metadata.labels["camel.apache.org/kamelet.type"]||""}},{key:"icon",value:function(){return this.metadata.annotations["camel.apache.org/kamelet.icon"]||""}},{key:"title",value:function(){return this.spec.definition.title}},{key:"properties",value:function(){return this.spec.definition.properties}}]),e}(),E=function e(){Object(x.a)(this,e),this.apiVersion="camel.apache.org/v1alpha1",this.kind="Kamelet",this.name=""},D=function e(){Object(x.a)(this,e),this.ref=new E,this.properties=void 0},T=function e(){Object(x.a)(this,e),this.ref=new E,this.properties=void 0},I=function e(){Object(x.a)(this,e),this.ref=new E,this.properties=void 0},K=function e(){Object(x.a)(this,e),this.source=new D,this.steps=[],this.sink=new T},X=function e(){Object(x.a)(this,e),this.name=""},Y=function e(){Object(x.a)(this,e),this.apiVersion="camel.apache.org/v1alpha1",this.kind="KameletBinding",this.metadata=new X,this.spec=new K},q=function e(t,n){var a=this;Object(x.a)(this,e),this.id="",this.name="",this.title="",this.kamelet=void 0,this.properties=[],this.id=t,this.kamelet=n,this.name=n.metadata.name,this.title=n.spec.definition.title,(n.spec.definition.properties?new Map(Object.entries(n.spec.definition.properties)):new Map).forEach((function(e,t,n){var i=new g;i.id=t,i.title=e.title,i.default=e.default,i.description=e.description,i.format=e.format,i.type=e.type,i["x-descriptors"]=e["x-descriptors"],a.properties.push(i)}))},L=n(95),R=n.n(L),_=new O.a,z=new O.a,B=new O.a,M=new O.a,P=function(e){return _.next(e)},V=function(){return _.asObservable()},J=function(e){return z.next(e)},A=function(){return z.asObservable()},F=function(e){return B.next(e)},U=function(){return B.asObservable()},G=function(e){return M.next([Date.now(),e])},H=function(){return M.asObservable()},W=function(e){var t=JSON.parse(e),n=new S;return n.apiVersion=t.apiVersion,n.kind=t.kind,n.metadata=t.metadata,n.spec=t.spec,n},Z=function(e,t){var n=e.find((function(e){return"connect"===e.type&&e.source===t.id}));return n&&e.find((function(e){return"connect"!==e.type&&e.id===n.target}))},Q=function(e){var t={};return e.forEach((function(e){e.value&&(t[e.id]=e.value)})),t},$=function(e){var t=new I;return t.ref.name=e.data.binding.kamelet.metadata.name,t.properties=Q(e.data.binding.properties),0===Object.keys(t.properties).length&&delete t.properties,t},ee=function(e){var t=new T;return t.ref.name=e.data.binding.kamelet.metadata.name,t.properties=Q(e.data.binding.properties),0===Object.keys(t.properties).length&&delete t.properties,t},te=function(e){var t=e.filter((function(e){return"source"===e.type})),n=[];t.forEach((function(t){for(var a=function(e){var t=new Y;return t.metadata.name=e.data.binding.name,t.spec.source.ref.name=e.data.binding.kamelet.metadata.name,t.spec.source.properties=Q(e.data.binding.properties),0===Object.keys(t.spec.source.properties).length&&delete t.spec.source.properties,t}(t),i=t;i;)(i=Z(e,i))&&"action"===i.type?a.spec.steps.push($(i)):i&&"sink"===i.type&&(a.spec.sink=ee(i));0===a.spec.steps.length&&delete a.spec.steps;var c=R.a.stringify(a,{mapAsMap:!0});n.push("---"),n.push(c),G(n.join("\n"))}))},ne=n(96),ae=(n(71),n(92),n(4)),ie=function(){var e=Object(p.a)(f.a.mark((function e(t){var n,a,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("kamelets/"+t);case 2:return n=e.sent,e.next=5,n.text();case 5:return a=e.sent,i=ne.load(a),e.abrupt("return",W(JSON.stringify(i)));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(a.useState)([]),t=Object(o.a)(e,2),n=t[0],i=t[1],c=Object(a.useState)("source"),r=Object(o.a)(c,2),s=r[0],l=r[1],d=Object(a.useState)(""),f=Object(o.a)(d,2),p=f[0],O=f[1],v=Object(a.useState)([]),x=Object(o.a)(v,2),g=x[0],k=x[1],y=function(e,t){var n=t.currentTarget.id;l(n),w(n)},w=function(e){var t=Object(u.a)(n).filter((function(t){return p?t.type()===e&&t.spec.definition.title.toLowerCase().includes(p.toLowerCase()):t.type()===e})).sort((function(e,t){return e.spec.definition.title<t.spec.definition.title?-1:e.spec.definition.title>t.spec.definition.title?1:0}));k(t)};return Object(a.useEffect)((function(){fetch("kamelets.txt").then((function(e){return e.text()})).then((function(e){var t=e.split("\n").map((function(e){return ie(e+".kamelet.yaml")}));Promise.all(t).then((function(e){i(e)}))}))}),[]),Object(a.useEffect)((function(){g&&0===g.length&&w(s)}),[n]),Object(a.useEffect)((function(){w(s)}),[p]),Object(ae.jsxs)("div",{className:"kamelets",children:[Object(ae.jsx)(b.a,{headingLevel:"h1",size:"md",children:"Kamelets"}),Object(ae.jsxs)("div",{children:[Object(ae.jsxs)(j.a,{isCompact:!0,"aria-label":"Default with single selectable",children:[Object(ae.jsx)(h.a,{text:"Source",buttonId:"source",isSelected:"source"===s,onChange:y}),Object(ae.jsx)(h.a,{text:"Action",buttonId:"action",isSelected:"action"===s,onChange:y}),Object(ae.jsx)(h.a,{text:"Sink",buttonId:"sink",isSelected:"sink"===s,onChange:y})]}),Object(ae.jsx)(m.a,{className:"text-field",type:"search",id:"search",name:"search",value:p||"",onChange:function(e){O(e)},autoComplete:"off",placeholder:"Search by name"})]}),Object(ae.jsxs)("div",{className:"inner",children:[Object(ae.jsx)("div",{className:"description",children:"Drag kamelet to the panel."}),g&&g.length>0&&g.map((function(e){return Object(ae.jsxs)("div",{className:"node react-flow__node-kamelet",onDragStart:function(t){t.dataTransfer.setData("kamelet",JSON.stringify(e)),function(e,t){e.dataTransfer.setData("application/reactflow",t),e.dataTransfer.setData("karavan/offsetX",e.nativeEvent.offsetX.toString()),e.dataTransfer.setData("karavan/offsetY",e.nativeEvent.offsetY.toString()),e.dataTransfer.effectAllowed="move"}(t,"")},draggable:!0,children:[Object(ae.jsx)("img",{draggable:"false",src:e.icon(),className:"kamelet-icon",alt:""}),Object(ae.jsx)("p",{className:"kamelet-title",children:e.spec.definition.title})]},e.metadata.name)}))]})]})},re=n(69),se=function(e){var t=e.data,n=e.isConnectable;return Object(ae.jsxs)(ae.Fragment,{children:[Object(ae.jsx)(l.d,{type:"target",position:l.e.Top}),Object(ae.jsx)("img",{draggable:"false",src:t.binding.kamelet.icon(),className:"kamelet-icon",alt:""}),Object(ae.jsx)("p",{className:"kamelet-title",children:t.label}),Object(ae.jsx)(l.d,{type:"source",position:l.e.Bottom,id:"from-action",isConnectable:n})]})},oe=Object(a.memo)(se),le=function(e){var t=e.data,n=e.isConnectable;return Object(ae.jsxs)(ae.Fragment,{children:[Object(ae.jsx)(l.d,{type:"source",position:l.e.Bottom,id:"from-source",isConnectable:n}),Object(ae.jsx)("img",{draggable:"false",src:t.binding.kamelet.icon(),className:"kamelet-icon",alt:""}),Object(ae.jsx)("p",{className:"kamelet-title",children:t.label})]})},ue=Object(a.memo)(le),de=function(e){var t=e.data;return Object(ae.jsxs)(ae.Fragment,{children:[Object(ae.jsx)(l.d,{type:"target",position:l.e.Top}),Object(ae.jsx)("img",{draggable:"false",src:t.binding.kamelet.icon(),className:"kamelet-icon",alt:""}),Object(ae.jsx)("p",{className:"kamelet-title",children:t.label})]})},fe=Object(a.memo)(de),pe=n(195),be=n(208),je=n(204),he=n(108),me=n.n(he),Oe=function(e){var t=e.onUpdate,n=Object(a.useState)({}),i=Object(o.a)(n,2),c=i[0],r=i[1],s=Object(a.useState)(!0),l=Object(o.a)(s,2),u=l[0],d=l[1],f=function(e,n){var a=Object.assign({},c);"title"===e&&(a.title=n),"name"===e&&(a.name=n),r(a),null===t||void 0===t||t.call(undefined,a)};return Object(a.useEffect)((function(){return V().subscribe((function(e){e?(r(e),d(!1)):d(!0)})).unsubscribe}),[]),Object(ae.jsx)("div",{className:u?"hidden":"properties",children:Object(ae.jsxs)(pe.a,{autoComplete:"off",children:[Object(ae.jsx)(b.a,{headingLevel:"h1",size:"md",children:"Kamelet Binding"}),Object(ae.jsx)(be.a,{label:"Name",isRequired:!0,fieldId:"name",children:Object(ae.jsx)(m.a,{className:"text-field",isRequired:!0,type:"text",id:"name",name:"name",value:(null===c||void 0===c?void 0:c.name)||"",onChange:function(e){return f("name",e)}})}),Object(ae.jsx)(be.a,{label:"Title",isRequired:!0,fieldId:"title",children:Object(ae.jsx)(m.a,{className:"text-field",isRequired:!0,type:"text",id:"title",name:"title",value:(null===c||void 0===c?void 0:c.title)||"",onChange:function(e){return f("title",e)}})}),Object(ae.jsx)(b.a,{headingLevel:"h1",size:"md",children:"Properties:"}),c&&c.properties&&c.properties.map((function(e){return Object(ae.jsx)(be.a,{label:e.title,fieldId:e.id,labelIcon:Object(ae.jsx)(je.a,{headerContent:e.title,bodyContent:e.description,children:Object(ae.jsx)("button",{type:"button","aria-label":"More info",onClick:function(e){return e.preventDefault()},className:"pf-c-form__group-label-help",children:Object(ae.jsx)(me.a,{noVerticalAlign:!0})})}),children:Object(ae.jsx)(m.a,{className:"text-field",isRequired:!0,type:"text",id:e.id,name:e.id,value:e.value,onChange:function(t){return function(e,t){var n=c.properties.findIndex((function(t){return t.id===e})),a=c.properties[n];a.value=t,c.properties[n]=a;var i=Object.assign({},c);r(i)}(e.id,t)}})},e.id)}))]})})},ve=n(209),xe=n(109),ge=n.n(xe),ke=function(e){var t=e.id,n=e.sourceX,a=e.sourceY,i=e.targetX,c=e.targetY,r=e.sourcePosition,s=e.targetPosition,u=(e.data,e.arrowHeadType),d=e.markerEndId,f=Object(l.i)({sourceX:n,sourceY:a,sourcePosition:r,targetX:i,targetY:c,targetPosition:s}),p=Object(l.k)(u,d),b=Object(l.j)({sourceX:n,sourceY:a,targetX:i,targetY:c}),j=Object(o.a)(b,2),h=j[0],m=j[1];return Object(ae.jsxs)(ae.Fragment,{children:[Object(ae.jsx)("path",{id:t,className:"react-flow__edge-path",d:f,markerEnd:p}),Object(ae.jsx)("foreignObject",{width:16,height:16,x:h-8,y:m-8,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml",children:Object(ae.jsx)(ve.a,{variant:"link",icon:Object(ae.jsx)(ge.a,{}),onKeyDown:function(e){8!==e.keyCode&&46!==e.keyCode||J(t)}})})]})},ye=0,we=function(){var e=Object(a.useState)(),t=Object(o.a)(e,2),n=t[0],i=t[1],c=Object(a.useState)([]),r=Object(o.a)(c,2),s=r[0],d=r[1],f=Object(a.useState)(new Map),p=Object(o.a)(f,2),b=p[0],j=p[1],h=Object(l.m)((function(e){return e.setSelectedElements}));Object(a.useEffect)((function(){d((function(e){return e.map((function(e){var t;return e.data=Object(re.a)(Object(re.a)({},e.data),{},{label:null===(t=b.get(e.id))||void 0===t?void 0:t.title}),e}))}))}),[b,d]),Object(a.useEffect)((function(){return A().subscribe((function(e){d((function(t){var n=Object(u.a)(t),a=n.findIndex((function(t){return t.id===e}));return n.splice(a,1),n}))})).unsubscribe}),[]),Object(a.useEffect)((function(){return U().subscribe((function(e){var t=[];d((function(e){return e.forEach((function(e){return t.push(e)})),e})),te(t)})).unsubscribe}),[]);var m={action:oe,source:ue,sink:fe},O={connect:ke};return Object(ae.jsxs)(l.h,{elements:s,onConnect:function(e){-1===s.findIndex((function(t){return t.source===e.source}))&&-1===s.findIndex((function(t){return t.target===e.target}))&&d((function(t){return Object(l.g)(Object(re.a)(Object(re.a)({},e),{},{type:"connect"}),t)}))},onElementsRemove:function(e){d((function(t){return Object(l.l)(e,t)})),j((function(t){return e.forEach((function(e){return t.delete(e.id)})),t}))},selectNodesOnDrag:!0,multiSelectionKeyCode:"",onSelectionChange:function(e){var t,n=e&&(null===(t=e[0])||void 0===t?void 0:t.id)||"";P(b&&b.get(n))},onLoad:function(e){return i(e)},onDrop:function(e){if(e.preventDefault(),n){var t=W(e.dataTransfer.getData("kamelet")),a=Number(e.dataTransfer.getData("karavan/offsetX")),i=Number(e.dataTransfer.getData("karavan/offsetY")),c=n.project({x:e.clientX-a-180,y:e.clientY-i-76}),r=t.metadata.name+"_".concat(ye++),s=new q(r,t);j(b.set(r,s));var o={id:r,type:t.metadata.labels["camel.apache.org/kamelet.type"],position:c,style:{opacity:1},data:{label:t.title(),binding:s}};d((function(e){return e.concat(o)})),h(o)}},onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"},nodeTypes:m,edgeTypes:O,defaultZoom:1,zoomOnScroll:!1,children:[Object(ae.jsx)(l.a,{variant:l.b.Dots,gap:24,size:.5}),Object(ae.jsx)(l.c,{}),Object(ae.jsx)(Oe,{onUpdate:function(e){var t=new Map(b);t.set(e.id,e),j(t)}})]})},Ce=n(197),Ne=n(210),Se=n(198),Ee=n(199),De=n(211),Te=n(114),Ie=n(203),Ke=n(200),Xe=n(201),Ye=n.p+"static/media/logo.9cbbe6ed.svg",qe=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],i=t[1],c=Object(a.useState)(),r=Object(o.a)(c,2),s=r[0],u=r[1];Object(a.useEffect)((function(){return H().subscribe((function(e){e&&u(e)})).unsubscribe}),[]),Object(a.useEffect)((function(){s&&i(!0)}),[s]);var d=Object(ae.jsx)(Ce.a,{children:Object(ae.jsx)(ve.a,{variant:"secondary",onClick:function(e){return F("")},children:"Generate"})}),f=Object(ae.jsx)(Ne.a,{logo:Object(ae.jsxs)("div",{className:"logo",children:[Object(ae.jsx)(Se.a,{src:Ye,alt:"Karavan"}),Object(ae.jsx)(b.a,{headingLevel:"h1",size:"3xl",children:"Karavan"})]}),headerTools:d}),p=Object(ae.jsx)(Ee.a,{children:Object(ae.jsx)(De.a,{id:"copy-button",textId:"code-content","aria-label":"Copy to clipboard",onClick:function(e){return function(e){var t=e.currentTarget.parentElement,n=document.createElement("textarea");n.value=s&&s[1]||"",t.appendChild(n),n.select(),document.execCommand("copy"),t.removeChild(n)}(e)},exitDelay:600,maxWidth:"110px",variant:"plain",children:"Copy to clipboard"})});return Object(ae.jsxs)(Te.a,{header:f,children:[Object(ae.jsx)("div",{className:"karavan",children:Object(ae.jsxs)(l.f,{children:[Object(ae.jsx)(ce,{}),Object(ae.jsx)("div",{className:"reactflow-wrapper",children:Object(ae.jsx)(we,{})})]})}),Object(ae.jsx)(Ie.a,{width:"75%",title:"KamelBinding",isOpen:n,onClose:function(){return i(!1)},actions:[Object(ae.jsx)(ve.a,{variant:"link",onClick:function(e){return i(!1)},children:"Close"},"cancel")],children:Object(ae.jsx)(Ke.a,{actions:p,children:Object(ae.jsx)(Xe.a,{id:"code-content",children:s&&s[1]})})})]})},Le=(n(176),[{path:"/",component:qe}]);c.a.render(Object(ae.jsx)(r.a,{forceRefresh:!0,children:Object(ae.jsx)(s.c,{children:Le.map((function(e){return Object(ae.jsx)(s.a,{exact:!0,path:e.path,render:function(){return Object(ae.jsx)(e.component,{})}},e.path)}))})}),document.getElementById("root"))},71:function(e,t,n){}},[[184,1,2]]]);
//# sourceMappingURL=main.4c0a74b1.chunk.js.map